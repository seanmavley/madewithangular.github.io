angular.module("madeWithFirebase",["ui.router","firebase","ngProgress"]).factory("Auth",["$firebaseAuth",function(e){return e()}]).factory("DatabaseRef",["$firebaseAuth",function(e){return firebase.database().ref()}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){e.state("home",{url:"/",templateUrl:"pages/home.html",controller:"HomeController",meta:{title:"Homepage",description:"Your Favorite Programming Languages, Side By Side"}}).state("about",{url:"/about",templateUrl:"templates/about.html",meta:{title:"About",description:"CodeBySide, a simple and fast way to compare code, side by side. Find out what CodeBySide is all about"}}).state("privacy",{url:"/privacy",templateUrl:"templates/privacy.html",meta:{title:"Privacy",description:"Details about your privacy on madeWithFirebase"}}).state("new",{url:"/submit",templateUrl:"pages/new.html",controller:"CreateController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Create new"}}).state("category",{url:"/category/:categoryId",templateUrl:"pages/category.html",controller:"CategoryController",meta:{title:"Category Detail",description:"Category Detail"}}).state("fire",{url:"/fires/:fireId",templateUrl:"pages/detail.html",controller:"DetailController",meta:{title:"Code Detail",description:"Code Description"}}).state("edit",{url:"/fires/:fireId/edit",templateUrl:"pages/edit.html",controller:"EditController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Edit ",description:"Code Description"}}).state("delete",{url:"/fires/:fireId",templateUrl:"codes/delete.html",controller:"DeleteController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Code Detail",description:"Code Description"}}).state("login",{url:"/login",templateUrl:"auth/login.html",controller:"LogRegController",params:{message:null,toWhere:null},meta:{title:"Login"}}).state("admin",{url:"/admin",templateUrl:"pages/admin.html",controller:"AdminController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Admin",restricted:!0}}),t.otherwise("/"),o.html5Mode(!0)}]).run(["$rootScope","$state","$location","Auth","ngProgressFactory",function(e,t,o,r,a){var n=a.createInstance();e.$on("$stateChangeError",function(e,o,r,a,i,l){"AUTH_REQUIRED"===l&&(t.go("login",{toWhere:o}),n.complete())}),e.$on("$stateChangeStart",function(e,t,o,r,a){n.start()}),e.$on("$stateChangeSuccess",function(){e.title=t.current.meta.title,e.description=t.current.meta.description,n.complete()})}]),angular.module("madeWithFirebase").controller("AdminController",["$scope","$firebaseObject","$firebaseArray","currentAuth","DatabaseRef",function(e,t,o,r,a){var n=a.child("fire").orderByChild("uid").equalTo(r.uid),i=o(n);e.admin=!1,console.log(r.email),"seanmavley@gmail.com"==r.email&&(e.admin=!0,console.log(e.admin)),i.$loaded().then(function(t){e.list=t}).catch(function(e){toastr.error(e.message)}),e.addCategories=function(){"seanmavley@gmail.com"!=r.email?toastr.error("You cannot initiate the categories"):a.child("categories").update({google:"Google",business:"Business",communication:"Communication",education:"Education",entertainment:"Entertainment",finance:"Finance","health-fitness":"Health & Fitness",lifestyle:"Lifestyle","media-video":"Media & Video","music-audio":"Music & Audio","news-magazines":"News & Magazines",photography:"Photography",productivity:"Productivity",shopping:"Shopping",social:"Social",sports:"Sports",tools:"Tools","travel-local":"Travel & Local",transportation:"Transportation",weather:"Weather",community:"From the Community"})}}]),angular.module("madeWithFirebase").controller("LogRegController",["$scope","$stateParams","Auth","$state","$rootScope","DatabaseRef","$firebaseObject",function(e,t,o,r,a,n,i){e.googleAuth=function(){var e=new firebase.auth.GoogleAuthProvider;e.addScope("https://www.googleapis.com/auth/plus.login"),o.$signInWithPopup(e).then(function(e){toastr.success("Logged in with Google successfully","Success"),r.go("admin")}).catch(function(e){toastr.error(e.message,e.reason)})},e.facebookAuth=function(){var e=new firebase.auth.FacebookAuthProvider;e.addScope("email"),o.$signInWithPopup(e).then(function(e){toastr.success("Logged in with Google successfully","Success"),r.go("home")}).catch(function(e){toastr.error(e.message,e.reason)})}}]),angular.module("madeWithFirebase").controller("CategoryController",["$scope","DatabaseRef","$firebaseArray","$stateParams",function(e,t,o,r){console.log("Category Controller loaded");var a=t.child("fire").orderByChild("category").equalTo(r.categoryId),n=o(a);n.$loaded().then(function(t){console.log(t),e.list=t}).catch(function(e){toastr.error(e.message)})}]),angular.module("madeWithFirebase").controller("DetailController",["$scope","$rootScope","$state","$stateParams","DatabaseRef","$firebaseObject","Auth",function(e,t,o,r,a,n,i){e.loading=!0;var l=n(a.child("fire").child(r.fireId));i.$onAuthStateChanged(function(t){t?(console.log("Signed in as:",t.uid),e.firebaseUserUid=t.uid):console.log("Not logged in")}),l.$loaded().then(function(t){e.loading=!1,e.fire=t,(e.firebaseUserUid=e.fire.uid)&&(e.allowed=!0,console.log(e.allowed))}),e.deleteFire=function(){swal({title:"Are you sure?",text:"You will not be able to reverse this process",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){console.log("deleting fire"),console.log(e.allowed),e.allowed?(console.log("delete happened"),l.$remove().then(function(e){swal("Deleted!","Resource deletion is complete.","success"),o.go("admin"),toastr.success("Deletion done!","Finished Deletion")})):toastr.error("You aint doing anything")})}}]),angular.module("madeWithFirebase").controller("EditController",["$scope","$firebaseObject","DatabaseRef","$stateParams","currentAuth",function(e,t,o,r,a){var n=t(o.child("fire").child(r.fireId));e.loading=!0,n.$loaded().then(function(t){if(t.uid!=a.uid)toastr.error("Not allowed","You are trying to edit a site you did not create."),e.allowed=!1;else{e.allowed=!0;(new Date).getTime();n.$bindTo(e,"formData").then(function(){e.loading=!1,toastr.info("All changes you make are saved in realtime to Firebase","Live saving enabled!")})}});var i=t(o.child("categories"));i.$loaded().then(function(t){e.categories=t},function(e){toastr.error(e.message,"Couldnt not load categories")})}]),angular.module("madeWithFirebase").controller("emailVerifyController",["$scope","$stateParams","currentAuth","DatabaseRef",function(e,t,o,r){console.log(o),e.doVerify=function(){firebase.auth().applyActionCode(t.oobCode).then(function(e){toastr.success("Verification happened","Success!")}).catch(function(t){e.error=t.message,toastr.error(t.message,t.reason,{timeOut:0})})}}]),angular.module("madeWithFirebase").controller("HomeController",["$scope","$rootScope","Auth","DatabaseRef","$firebaseArray","$firebaseObject",function(e,t,o,r,a,n){var i=a(r.child("fire"));e.filterKey=function(e){return e};var l=n(r.child("categories"));l.$loaded().then(function(t){e.categories=t},function(e){toastr.error(e.message,"Couldnt not load categories")}),i.$loaded().then(function(t){e.list=t}).catch(function(e){toastr.error(e.message)})}]),angular.module("madeWithFirebase").controller("MenuController",["$scope","Auth","$state",function(e,t,o){t.$onAuthStateChanged(function(t){null!=t?e.loggedIn=!0:e.loggedIn=!1}),e.logout=function(){t.$signOut(),t.$onAuthStateChanged(function(e){console.log("loggedout")}),o.go("login")}}]),angular.module("madeWithFirebase").controller("CreateController",["$scope","$state","$firebaseObject","$firebaseArray","DatabaseRef","Auth","currentAuth",function(e,t,o,r,a,n,i){e.sending=!1;var l=r(a.child("fire")),s=o(a.child("categories"));s.$loaded().then(function(t){e.categories=t},function(e){toastr.error(e.message,"Couldnt not load categories")}),e.addNew=function(){if(e.addForm.$invalid)toastr.error("Please fill the form, all of it!","Throw in the best of your coding spices.","It means a lot!","Incomplete form");else{toastr.info("Saving begins","Sending your submission to the Firebase. Hold on!"),e.sending=!0;var o=(new Date).getTime();e.formData.uid=i.uid,e.formData.createdBy=i.displayName,e.formData.createdAt=o,l.$add(e.formData).then(function(e){toastr.clear(),toastr.success("Saving happened"),t.go("fire",{fireId:e.key})},function(e){toastr.error(e.reason,e.message)})}}}]),$(document).foundation(),toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};